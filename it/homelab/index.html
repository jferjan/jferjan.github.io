
<!doctype html>
<html lang="sl" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jaka.ferjan.net/it/homelab/">
      
      
        <link rel="prev" href="../cestitke/">
      
      
        <link rel="next" href="../forward-auth/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Homelab z Docker, Traefik, Portainer, Authentik - jaka.ferjan.net</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link rel="icon" type="image/png" href="/img/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/img/favicon.svg" />
  <link rel="icon" type="image/x-icon" href="/img/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="Jaka Ferjan" />
  <link rel="manifest" href="site.webmanifest" />
  

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#homelab-z-docker-traefik-portainer-authentik" class="md-skip">
          Skoči na vsebino
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Noga">
    <a href="../.." title="jaka.ferjan.net" class="md-header__button md-logo" aria-label="jaka.ferjan.net" data-md-component="logo">
      
  <img src="../../img/JF_logo_white_on_transparent.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            jaka.ferjan.net
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Homelab z Docker, Traefik, Portainer, Authentik
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Preklopi na temni način"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Preklopi na temni način" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Preklopi na svetli način"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Preklopi na svetli način" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Išči" placeholder="Išči" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Iskanje">
        
        <button type="reset" class="md-search__icon md-icon" title="Počisti" aria-label="Počisti" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializacija iskanja
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Zavihki" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Informacijska Tehnologija

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../kolesarjenje/" class="md-tabs__link">
          
  
  
    
  
  Kolesarjenje

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../hribi/" class="md-tabs__link">
          
  
  
    
  
  Hribi

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../potapljanje/" class="md-tabs__link">
          
  
  
    
  
  Potapljanje

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigacija" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="jaka.ferjan.net" class="md-nav__button md-logo" aria-label="jaka.ferjan.net" data-md-component="logo">
      
  <img src="../../img/JF_logo_white_on_transparent.png" alt="logo">

    </a>
    jaka.ferjan.net
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Informacijska Tehnologija
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Informacijska Tehnologija
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spletno-mesto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Potrebuješ brezplačno spletno mesto?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cestitke/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ferjanove avtomatične čestitke
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Homelab z Docker, Traefik, Portainer, Authentik
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Homelab z Docker, Traefik, Portainer, Authentik
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Kazalo">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Kazalo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#uvod" class="md-nav__link">
    <span class="md-ellipsis">
      Uvod
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Uvod">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#namen" class="md-nav__link">
    <span class="md-ellipsis">
      Namen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cilji" class="md-nav__link">
    <span class="md-ellipsis">
      Cilji
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zahteve" class="md-nav__link">
    <span class="md-ellipsis">
      Zahteve
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#namestitev" class="md-nav__link">
    <span class="md-ellipsis">
      Namestitev
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Namestitev">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zagon-virtualke-ubuntu-z-vagrant" class="md-nav__link">
    <span class="md-ellipsis">
      Zagon virtualke Ubuntu z Vagrant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#konfiguracija-ssh-dostopa" class="md-nav__link">
    <span class="md-ellipsis">
      Konfiguracija SSH dostopa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namestitev-docker-ce" class="md-nav__link">
    <span class="md-ellipsis">
      Namestitev Docker-ce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-oz-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      DNS oz. hosts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-omrezja" class="md-nav__link">
    <span class="md-ellipsis">
      Docker omrežja
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traefik" class="md-nav__link">
    <span class="md-ellipsis">
      Traefik
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Traefik">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#traefikdataacmejson" class="md-nav__link">
    <span class="md-ellipsis">
      traefik/data/acme.json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traefikdatatraefikyml" class="md-nav__link">
    <span class="md-ellipsis">
      traefik/data/traefik.yml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traefikcf_api_token" class="md-nav__link">
    <span class="md-ellipsis">
      traefik/cf_api_token
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traefikenv" class="md-nav__link">
    <span class="md-ellipsis">
      traefik/.env
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traefikdocker-composeyml" class="md-nav__link">
    <span class="md-ellipsis">
      traefik/docker-compose.yml
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#portainer" class="md-nav__link">
    <span class="md-ellipsis">
      Portainer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentik" class="md-nav__link">
    <span class="md-ellipsis">
      Authentik
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentik">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nastavitve-authentik" class="md-nav__link">
    <span class="md-ellipsis">
      Nastavitve Authentik
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Nastavitve Authentik">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dodajanje-novega-providerja-v-authentik" class="md-nav__link">
    <span class="md-ellipsis">
      Dodajanje novega providerja v Authentik
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dodajanje-aplikacije-v-authentik" class="md-nav__link">
    <span class="md-ellipsis">
      Dodajanje aplikacije v Authentik
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nastavitve-portainer-za-oauth" class="md-nav__link">
    <span class="md-ellipsis">
      Nastavitve Portainer za Oauth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-delovanja" class="md-nav__link">
    <span class="md-ellipsis">
      Test delovanja
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nastavitve-mac-os-za-neprestano-delovanje" class="md-nav__link">
    <span class="md-ellipsis">
      Nastavitve Mac OS za neprestano delovanje
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../forward-auth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vnaprejšnja avtentikacija z Authentikom in Traefikom
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tailscale-in-headscale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tailscale in Headscale zasebno omrežje
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blokada-chatgpt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kako blokirati ChatGPT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../no-sleep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Powershelll skripta za preprečevanje neaktivnosti
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../moj-ca/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Si želiš imeti svoj CA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smrekca/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Smrekca, razvejana, obrezana, zapakirana
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../github-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testiranje GitHub Actions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../kolesarjenje/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Kolesarjenje
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Kolesarjenje
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kolesarjenje/bikepacking-gear/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bikepacking gear
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../hribi/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Hribi
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Hribi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hribi/rob-smrti/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Po bližnjici na rob smrti
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hribi/bivak-v-snegu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trodnevni snežni bivak na Komni
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../potapljanje/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Potapljanje
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Potapljanje
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Kazalo">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Kazalo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#uvod" class="md-nav__link">
    <span class="md-ellipsis">
      Uvod
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Uvod">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#namen" class="md-nav__link">
    <span class="md-ellipsis">
      Namen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cilji" class="md-nav__link">
    <span class="md-ellipsis">
      Cilji
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zahteve" class="md-nav__link">
    <span class="md-ellipsis">
      Zahteve
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#namestitev" class="md-nav__link">
    <span class="md-ellipsis">
      Namestitev
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Namestitev">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zagon-virtualke-ubuntu-z-vagrant" class="md-nav__link">
    <span class="md-ellipsis">
      Zagon virtualke Ubuntu z Vagrant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#konfiguracija-ssh-dostopa" class="md-nav__link">
    <span class="md-ellipsis">
      Konfiguracija SSH dostopa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namestitev-docker-ce" class="md-nav__link">
    <span class="md-ellipsis">
      Namestitev Docker-ce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-oz-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      DNS oz. hosts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-omrezja" class="md-nav__link">
    <span class="md-ellipsis">
      Docker omrežja
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traefik" class="md-nav__link">
    <span class="md-ellipsis">
      Traefik
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Traefik">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#traefikdataacmejson" class="md-nav__link">
    <span class="md-ellipsis">
      traefik/data/acme.json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traefikdatatraefikyml" class="md-nav__link">
    <span class="md-ellipsis">
      traefik/data/traefik.yml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traefikcf_api_token" class="md-nav__link">
    <span class="md-ellipsis">
      traefik/cf_api_token
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traefikenv" class="md-nav__link">
    <span class="md-ellipsis">
      traefik/.env
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traefikdocker-composeyml" class="md-nav__link">
    <span class="md-ellipsis">
      traefik/docker-compose.yml
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#portainer" class="md-nav__link">
    <span class="md-ellipsis">
      Portainer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentik" class="md-nav__link">
    <span class="md-ellipsis">
      Authentik
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentik">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nastavitve-authentik" class="md-nav__link">
    <span class="md-ellipsis">
      Nastavitve Authentik
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Nastavitve Authentik">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dodajanje-novega-providerja-v-authentik" class="md-nav__link">
    <span class="md-ellipsis">
      Dodajanje novega providerja v Authentik
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dodajanje-aplikacije-v-authentik" class="md-nav__link">
    <span class="md-ellipsis">
      Dodajanje aplikacije v Authentik
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nastavitve-portainer-za-oauth" class="md-nav__link">
    <span class="md-ellipsis">
      Nastavitve Portainer za Oauth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-delovanja" class="md-nav__link">
    <span class="md-ellipsis">
      Test delovanja
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nastavitve-mac-os-za-neprestano-delovanje" class="md-nav__link">
    <span class="md-ellipsis">
      Nastavitve Mac OS za neprestano delovanje
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
        <a href="../../zapisi/#tag:it" class="md-tag">IT</a>
      
    
  </nav>



<h1 id="homelab-z-docker-traefik-portainer-authentik">Homelab z Docker, Traefik, Portainer, Authentik<a class="headerlink" href="#homelab-z-docker-traefik-portainer-authentik" title="Permanent link">&para;</a></h1>
<h2 id="uvod">Uvod<a class="headerlink" href="#uvod" title="Permanent link">&para;</a></h2>
<h3 id="namen">Namen<a class="headerlink" href="#namen" title="Permanent link">&para;</a></h3>
<ul>
<li>Vzpostaviti lokalno oklje za testiranje dokeriziranih informacijskih rešitev.</li>
<li>Nabiranje izkušenj s Cloudflare, Traefik, Vagrant, Ubuntu, Let's Encrypt, Portainer, Authentik</li>
</ul>
<h3 id="cilji">Cilji<a class="headerlink" href="#cilji" title="Permanent link">&para;</a></h3>
<p>Cilj je vzpostaviti <strong>homelab</strong> okolje, ki bo v prvi vrsti namenjeno testiranju dokeriziranih informacijskih rešitev oz. aplikacij. Vse aplikacije znotraj homelab okolja bodo od zunaj dosegljive preko ingres kontrolerja <strong>Traefic</strong> preko <strong>HTTPS</strong> protokola. Certifikati bodo od <strong>Let's Encrypt</strong> z vzpostavljeno avtomatizacijo nameščanja/podaljševanja. Pri tem bo uporabljen <strong>Cloudflare API</strong> za <strong>Let'Encrypt DNS challenge</strong>. Upravljanje vsebnikov bo potekalo preko upravljavske konzole <strong>Portainer</strong>. Dostopi do posameznih upravljavskih vmesnikov bodo omogočeni preko OAuth2 servisa <strong>Authentik</strong>. Celotna postavitev bo zaradi lažje prenosljivosti postavljena v <strong>Ubuntu</strong> virtualki s pomočjo <strong>Vagrant</strong> okolja in <strong>Virtualbox</strong> providerja.</p>
<h3 id="zahteve">Zahteve<a class="headerlink" href="#zahteve" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://www.vagrantup.com/">Vagrant</a></li>
<li><a href="https://www.virtualbox.org/">Virtualbox</a></li>
<li><a href="https://dash.cloudflare.com/">Cloudflare</a></li>
</ul>
<h2 id="namestitev">Namestitev<a class="headerlink" href="#namestitev" title="Permanent link">&para;</a></h2>
<p>Opis postopka namestiteve. </p>
<p>Namestitev je potekala na:
- macOS Big Sur 11.7.10
- Vagrant 2.4.1
- Virtualbox 7.0</p>
<p>Namestitev je potekala znotraj <strong>docker-ce</strong> okolja na virtualki <strong>ubuntu/focal64</strong>. </p>
<p>Virtualka je bila zagnana s pomočjo Vagrant-a in Virtualboxa.</p>
<p>V virtualki je bil nameščen docker-ce. </p>
<p>Z docker compose so bili zagnani vsebniki: 
-   Traefik - ingress kontroler, avtomatizacija Let's Encrypt
-   Portainer - GUI za upravljanje vsebnikov
-   Authentik - Oauth2 servis</p>
<h3 id="zagon-virtualke-ubuntu-z-vagrant">Zagon virtualke Ubuntu z Vagrant<a class="headerlink" href="#zagon-virtualke-ubuntu-z-vagrant" title="Permanent link">&para;</a></h3>
<p>S pomočjo Vagranta bomo zagnali virtualko <a href="https://app.vagrantup.com/ubuntu/boxes/focal64">ubuntu/focal64</a>.</p>
<p>Naredi template za <code>Vagrantfile</code>.</p>
<div class="highlight"><pre><span></span><code>vagrant init ubuntu/focal64
</code></pre></div>
<p>Ciljna vsebina datoteke <code>Vagranfile</code>:</p>
<div class="highlight"><pre><span></span><code><span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">config</span><span class="o">|</span>
<span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ubuntu/focal64&quot;</span>
<span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">hostname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;lab.ferjan.net&quot;</span>
<span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;public_network&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">ip</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.10&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">bridge</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;en0: Wi-Fi (AirPort)&quot;</span>
<span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span><span class="w"> </span><span class="s2">&quot;virtualbox&quot;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">vb</span><span class="o">|</span>
<span class="w">    </span><span class="n">vb</span><span class="o">.</span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;8192&quot;</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>Nastavimo javno omrežje tipa bridged network. Omrežje bo imelo fiksni IP naslov 192.168.1.10.</p>
<blockquote>
<p>Za bridge uporabimo ime omrežnega vmesnika preko katerega smo povezani. V kolikor ne vemo imena vmesnika lahko v inicialni kongfiguraciji navedbo <code>, bridge: "en0: Wi-Fi (AirPort)"</code> izpustimo in nas bo Vagrant pozval k izbiri vmesnika ob vsakokratnem zagonu virtualke. V tem primeru na Vagrant ponudi seznam vseh mrežnih vmesnikov z imeni mrežnih vmesnikov.   </p>
</blockquote>
<p>Virtualko zaženemo z:</p>
<div class="highlight"><pre><span></span><code>vagrant up
</code></pre></div>
<p>Ko je virtualka zagnana se lahko nanjo povežemo preko:</p>
<div class="highlight"><pre><span></span><code>vagrant ssh
</code></pre></div>
<p>Preko SSH se lahko povežemo tudi tako, da dodamo vagrant ssh-config v konfiguracijo svojega klienta.</p>
<div class="highlight"><pre><span></span><code>vagrant ssh-config &gt;&gt; ~/.ssh/config
</code></pre></div>
<p>Nato se lahko povežemo z:</p>
<div class="highlight"><pre><span></span><code>ssh default
</code></pre></div>
<blockquote>
<p>V kolikor nas moti privzeto ime "default" ga lahko spremenimo v konfiguraciji v Vagrantfile.</p>
</blockquote>
<p>Tako, povezani bi morali biti v virtualko.</p>
<p>Preverimo stanje omrežnih vmesnikov:</p>
<div class="highlight"><pre><span></span><code>ip addr
</code></pre></div>
<p>Ugotovimo, da je naš IP naslov <code>192.168.1.10</code> na vmesniku <code>enp0s8</code>, vagrant pa je dvignil tudi IP naslov v omrežju <code>10.0.2.0/24</code> na vmesniku <code>enp0s3</code></p>
<p>Preverimo route:</p>
<div class="highlight"><pre><span></span><code>sudo apt install net-tools  
route -n
</code></pre></div>
<p>Ugotovimo, da je privzeti gateway usmerjen na IP naslov <code>10.0.2.2</code> privzetega NAT omrežja na vmesniku <code>enp0s3</code></p>
<div class="highlight"><pre><span></span><code>vagrant@ubuntu-focal:~$ route -n | grep UG
0.0.0.0         10.0.2.2        0.0.0.0         UG    100    0        0 enp0s3
</code></pre></div>
<p>Kot vidimo privzeti gateway ni ustrezen, ker kaže na IP naslov <code>10.0.2.2</code> privzetega NAT omrežja na vmesniku <code>enp0s3</code>, medtem ko je IP naslov <code>192.168.1.10</code> bridge omrežja na vmesniku <code>enp0s8</code>. Potrebno bo vpisati novi gateway <code>192.168.1.1</code> in pobrisati obstoječega na vmesniku <code>enp0s3</code>. </p>
<blockquote>
<p>Kljub temu, da smo nastavili bridge network bo Vagrant vedno skonfiguriral tudi NAT omrežje, kamor bo privzeto usmerjen tudi privzeti gateway. Gre za privzeto delovanje Vagrant-a, ki pa je lahko problematično v primeru, da poleg privzetega vagrant omrežja dodamo še dodatno omrežje za dostop od zunaj. Rešitev je v spremembi privzetega gateway-a, ki jo dokumentiram v nadaljevanju. Zadeva se v podobni obliki nahaja tudi v uradni dokumentaciji (https://developer.hashicorp.com/vagrant/docs/networking/public_network#default-router), vendar so bili v našem primeru potrebni popravki. </p>
</blockquote>
<p>Spremembo privzetaga gateway-a lahko naredimo preko Vagrant shell provision skripte, ki jo dodamo na konec Vagrantfile datototeke.</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="c1"># Change default gateway  (Run Always)</span>
<span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span><span class="w"> </span><span class="s2">&quot;shell&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="ss">run</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;always&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">inline</span><span class="p">:</span><span class="w"> </span><span class="o">&lt;&lt;-</span><span class="dl">SHELL</span>
<span class="sh">      # set default gateway to 192.168.1.1</span>
<span class="sh">      sudo route add default gw 192.168.1.1</span>
<span class="sh">      # delete default gateway enp0s3 (could be eth0 in your case)</span>
<span class="sh">      eval `route -n | awk &#39;{ if ($8 == &quot;enp0s3&quot; &amp;&amp; $2 != &quot;0.0.0.0&quot;) print &quot;sudo route del default gw &quot; $2; }&#39;`</span>
<span class="dl">  SHELL</span>
</code></pre></div>
<p>Vagrant ponovno preženemo in preverimo, če smo uspešno poravili privzeti gateway.  </p>
<div class="highlight"><pre><span></span><code>vagrant@ubuntu-focal:~$ route -n | grep UG
0.0.0.0         192.168.1.1     0.0.0.0         UG    0      0        0 enp0s8
</code></pre></div>
<h3 id="konfiguracija-ssh-dostopa">Konfiguracija SSH dostopa<a class="headerlink" href="#konfiguracija-ssh-dostopa" title="Permanent link">&para;</a></h3>
<p>Na svojem klientu naredimo keypair z <code>ssh-keygen</code>.
Vsebino javnega ključa ~/.ssh/id_rsa.pub dodamo v virtualko v datoteko <code>~/.ssh/authorized_keys</code></p>
<p>Obstoječi javni ključ iz <code>~/.ssh/authorized_keys</code> izbrišemo. Virtualka bo namreč dosegljiva od zunaj in ključ predstavlja nesprejemljivo varnostno tveganje.
Ko izbrišemo obstoječi javni ključ je potrebno v Vagrantfile dodati:</p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># SSH config</span>
<span class="n">config</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">private_key_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;~/.ssh/id_rsa&quot;</span>
<span class="n">config</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">forward_agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">true</span>
</code></pre></div>
Brez eksplicitne nastavitve lokacije privatnega ključa nam ne bo deloval <code>vagrant up</code>.</p>
<h3 id="namestitev-docker-ce">Namestitev Docker-ce<a class="headerlink" href="#namestitev-docker-ce" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="c1"># Update packages</span>
<span class="w">    </span>sudo<span class="w"> </span>apt<span class="w"> </span>update
<span class="w">    </span><span class="c1"># Install prerequisites</span>
<span class="w">    </span>sudo<span class="w"> </span>apt<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>apt-transport-https<span class="w"> </span>ca-certificates<span class="w"> </span>curl<span class="w"> </span>software-properties-common
<span class="w">    </span><span class="c1"># add the GPG key for the official Docker repository</span>
<span class="w">    </span>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://download.docker.com/linux/ubuntu/gpg<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>apt-key<span class="w"> </span>add<span class="w"> </span>-
<span class="w">    </span><span class="c1"># Add the Docker repository to APT sources</span>
<span class="w">    </span>sudo<span class="w"> </span>add-apt-repository<span class="w"> </span><span class="s2">&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable&quot;</span>
<span class="w">    </span><span class="c1"># Install Docker</span>
<span class="w">    </span>sudo<span class="w"> </span>apt<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>docker-ce
<span class="w">    </span><span class="c1"># Add vagrant user to docker group</span>
<span class="w">    </span>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span>vagrant
<span class="w">    </span><span class="c1"># Change current login session to docker group</span>
<span class="w">    </span>newgrp<span class="w"> </span>docker
</code></pre></div>
<p>Docker je nameščen.  </p>
<h3 id="dns-oz-hosts">DNS oz. hosts<a class="headerlink" href="#dns-oz-hosts" title="Permanent link">&para;</a></h3>
<p>V lokalno hosts datoteko dodamo:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># lab.ferjan.net</span>
<span class="m">192</span>.168.1.10<span class="w"> </span>traefik.lab.ferjan.net
<span class="m">192</span>.168.1.10<span class="w"> </span>portainer.lab.ferjan.net
<span class="m">192</span>.168.1.10<span class="w"> </span>authentik.lab.ferjan.net
</code></pre></div>
<p>V kolikor imamo nameščen DNS strežnik (npr. pi-hole) lahko namesto hosts datoteke vnesemo zapise v DNS. </p>
<p>DNS zapise lahko vnesemo tudi v javni DNS. V kolikor želimo, da je homelab dosegljiv od zunaj uporabimo javni IP, v nasprotnem primeru pa preslikamo zapise v lokalni IP. </p>
<blockquote>
<p>V kolikor naslovov ne bomo imeli v DNS se je potrebno zavedati, da nekatere aplikacije potrebujejo razreševanje domenskih naslovov. Pri takšnih vsebnikih lahko preslikave zagotovimo z <a href="https://github.com/compose-spec/compose-spec/blob/main/spec.md#extra_hosts">extra_hosts</a>.</p>
</blockquote>
<h3 id="docker-omrezja">Docker omrežja<a class="headerlink" href="#docker-omrezja" title="Permanent link">&para;</a></h3>
<p>Za proksiranje zahtevkov od Traefic do zalednih storitev bomo potrebovali Docker omrežje, ki smo ga poimenovali "<strong>proxy</strong>".</p>
<div class="highlight"><pre><span></span><code>docker network create proxy
</code></pre></div>
<p>Za zaledno komunikacijo med vsebniki Authentik bomo potrebovali Docker omrežje, ki smo ga poimenovali "<strong>backend</strong>".</p>
<div class="highlight"><pre><span></span><code>docker network create backend
</code></pre></div>
<h2 id="traefik">Traefik<a class="headerlink" href="#traefik" title="Permanent link">&para;</a></h2>
<p>Pripravimo datotečno strukturo za Traefik.</p>
<div class="highlight"><pre><span></span><code>./traefik
├──<span class="w"> </span>data
│<span class="w">   </span>├──<span class="w"> </span>acme.json
│<span class="w">   </span>└──<span class="w"> </span>traefik.yml
└──<span class="w"> </span>.env
└──<span class="w"> </span>cf_api_token.txt
└──<span class="w"> </span>docker-compose.yml
</code></pre></div>
<p><code>acme.json</code> - tukaj bo Traefik avtomatično odlagal certifikate
<code>traefik.yml</code> - konfiguracija Traefik-a 
<code>.env</code> - okoljske spremenljivke
<code>cf_api_token.txt</code></p>
<h3 id="traefikdataacmejson">traefik/data/acme.json<a class="headerlink" href="#traefikdataacmejson" title="Permanent link">&para;</a></h3>
<p>Traefik zahteva, da ima datoteka <code>acme.json</code> ustrezne pravice.</p>
<div class="highlight"><pre><span></span><code>chmod 600 acme.json
</code></pre></div>
<h3 id="traefikdatatraefikyml">traefik/data/traefik.yml<a class="headerlink" href="#traefikdatatraefikyml" title="Permanent link">&para;</a></h3>
<p>V konfiguraciji Traefika je potrebno za začetek le <strong>popraviti email</strong>. </p>
<p>Kasneje, ko bomo preverili in potrdili uspešnost avtomatizirane izdaje staging certifikatov, bomo konfiguracijo <strong>caServer</strong> popravili iz <strong>Staging</strong> na <strong>Prod</strong>. Produkcije ne nastavimo predčasno, ker se lahko, v primeru napak, zgodi, da bo zaradi rate-limitinga začasno blokirano izdajanje certifikatov. Ko bomo na tej točki, da bomo popravljali na <strong>Prod</strong> je potrebno pred spremembo počistiti vsebino <code>acme.json</code> datoteke, da bo lahko Trefik v njo dodal produkcijski certifikat.</p>
<div class="highlight"><pre><span></span><code><span class="nt">api</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dashboard</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">entryPoints</span><span class="p">:</span>
<span class="w">  </span><span class="nt">http</span><span class="p">:</span>
<span class="w">    </span><span class="nt">address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;:80&quot;</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">redirections</span><span class="p">:</span>
<span class="w">        </span><span class="nt">entryPoint</span><span class="p">:</span>
<span class="w">          </span><span class="nt">to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https</span>
<span class="w">          </span><span class="nt">scheme</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https</span>
<span class="w">  </span><span class="nt">https</span><span class="p">:</span>
<span class="w">    </span><span class="nt">address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;:443&quot;</span>
<span class="nt">serversTransport</span><span class="p">:</span>
<span class="w">  </span><span class="nt">insecureSkipVerify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">providers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unix:///var/run/docker.sock&quot;</span>
<span class="w">    </span><span class="nt">exposedByDefault</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="c1"># file:</span>
<span class="w">  </span><span class="c1">#   filename: /config.yml</span>
<span class="nt">certificatesResolvers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">cloudflare</span><span class="p">:</span>
<span class="w">    </span><span class="nt">acme</span><span class="p">:</span>
<span class="w">      </span><span class="nt">email</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example@example.com</span>
<span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">acme.json</span>
<span class="w">      </span><span class="c1"># caServer: https://acme-v02.api.letsencrypt.org/directory # prod (default)</span>
<span class="w">      </span><span class="nt">caServer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://acme-staging-v02.api.letsencrypt.org/directory</span><span class="w"> </span><span class="c1"># staging</span>
<span class="w">      </span><span class="nt">dnsChallenge</span><span class="p">:</span>
<span class="w">        </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cloudflare</span>
<span class="w">        </span><span class="c1">#disablePropagationCheck: true # uncomment this if you have issues pulling certificates through cloudflare, By setting this flag to true disables the need to wait for the propagation of the TXT record to all authoritative name servers.</span>
<span class="w">        </span><span class="c1">#delayBeforeCheck: 60s # uncomment along with disablePropagationCheck if needed to ensure the TXT record is ready before verification is attempted </span>
<span class="w">        </span><span class="nt">resolvers</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;1.1.1.1:53&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;1.0.0.1:53&quot;</span>
</code></pre></div>
<h3 id="traefikcf_api_token">traefik/cf_api_token<a class="headerlink" href="#traefikcf_api_token" title="Permanent link">&para;</a></h3>
<p>Naredi token na <a href="https://dash.cloudflare.com/profile/api-tokens">Cloudflare User API tokens</a> in ga daj v datoteko <code>traefik/cf_api_token.txt</code></p>
<ul>
<li>Token name: <strong>Homelab Traefik</strong></li>
<li>Permissions: <strong>Zone, Zone, Read</strong>   |   <strong>Zone, DNS, Edit</strong></li>
<li>Zone Resources: <strong>Include, Specific zone, ferjan.net</strong></li>
<li>Client IP address filtering: <strong>Is in, <em>my_public_ip</em></strong></li>
</ul>
<p>več na https://www.youtube.com/watch?v=n1vOfdz5Nm8&amp;t=1076s</p>
<h3 id="traefikenv">traefik/.env<a class="headerlink" href="#traefikenv" title="Permanent link">&para;</a></h3>
<p>Potrebujemo paket <strong>apache2-utils</strong>, da bomo lahko uporabili orodje <strong>htpasswd</strong>.</p>
<div class="highlight"><pre><span></span><code>sudo apt -y install apache2-utils
</code></pre></div>
<p>Ustvari poverilnice in nastavi geslo.</p>
<div class="highlight"><pre><span></span><code>echo $(htpasswd -nB admin) | sed -e s/\\$/\\$\\$/g
</code></pre></div>
<p>Poverilnice vstavi v <code>.env</code> datoteko z vsebino:</p>
<div class="highlight"><pre><span></span><code>TRAEFIK_DASHBOARD_CREDENTIALS=admin:dsfsdfsasf...
</code></pre></div>
<h3 id="traefikdocker-composeyml">traefik/docker-compose.yml<a class="headerlink" href="#traefikdocker-composeyml" title="Permanent link">&para;</a></h3>
<p>Pripravimo datoteko <code>docker-compose.yml</code>.</p>
<blockquote>
<p>Image tag nastavimo na <a href="https://github.com/traefik/traefik/releases/latest">zadnjo stabilno različico</a>.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">traefik</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">traefik:v3.1.5</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">traefik</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">security_opt</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-new-privileges:true</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proxy</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80:80</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443:443</span>
<span class="w">      </span><span class="c1"># - 443:443/tcp # Uncomment if you want HTTP3</span>
<span class="w">      </span><span class="c1"># - 443:443/udp # Uncomment if you want HTTP3</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CF_DNS_API_TOKEN_FILE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/run/secrets/cf_api_token</span><span class="w"> </span><span class="c1"># note using _FILE for docker secrets</span>
<span class="w">      </span><span class="c1"># CF_DNS_API_TOKEN: ${CF_DNS_API_TOKEN} # if using .env</span>
<span class="w">      </span><span class="nt">TRAEFIK_DASHBOARD_CREDENTIALS</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${TRAEFIK_DASHBOARD_CREDENTIALS}</span>
<span class="w">    </span><span class="nt">secrets</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cf_api_token</span>
<span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.env</span><span class="w"> </span><span class="c1"># use .env</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/localtime:/etc/localtime:ro</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./data/traefik.yml:/traefik.yml:ro</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./data/acme.json:/acme.json</span>
<span class="w">      </span><span class="c1"># - ./data/config.yml:/config.yml:ro</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.enable=true&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.traefik.entrypoints=http&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.traefik.rule=Host(`traefik.lab.ferjan.net`)&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.middlewares.traefik-auth.basicauth.users=${TRAEFIK_DASHBOARD_CREDENTIALS}&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.middlewares.traefik-https-redirect.redirectscheme.scheme=https&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.middlewares.sslheader.headers.customrequestheaders.X-Forwarded-Proto=https&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.traefik.middlewares=traefik-https-redirect&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.traefik-secure.entrypoints=https&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.traefik-secure.rule=Host(`traefik.lab.ferjan.net`)&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.traefik-secure.middlewares=traefik-auth&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.traefik-secure.tls=true&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.traefik-secure.tls.certresolver=cloudflare&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.traefik-secure.tls.domains[0].main=lab.ferjan.net&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.traefik-secure.tls.domains[0].sans=*.lab.ferjan.net&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.traefik-secure.service=api@internal&quot;</span>

<span class="nt">secrets</span><span class="p">:</span>
<span class="w">  </span><span class="nt">cf_api_token</span><span class="p">:</span>
<span class="w">    </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./cf_api_token.txt</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">proxy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<p>Zaženemo Traefik</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>Preverimo delovanje:</p>
<div class="highlight"><pre><span></span><code>docker logs traefik
cat /vagrant/traefik/data/acme.json
</code></pre></div>
<p>Preverimo nadzorno konzolo na naslovu https://traefik.lab.ferjan.net, kjer se prijavimo s poverilnicami iz datoteke <code>.env</code>.</p>
<h2 id="portainer">Portainer<a class="headerlink" href="#portainer" title="Permanent link">&para;</a></h2>
<p>Pripravimo datotečno strukturo za Portainer.</p>
<div class="highlight"><pre><span></span><code>./portainer
├──<span class="w"> </span>data
└──<span class="w"> </span>docker-compose.yml
</code></pre></div>
<p>Image tag nastavimo na <a href="https://github.com/portainer/portainer/releases/latest">zadnjo stabilno različico</a>.</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">portainer</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">portainer/portainer-ce:2.21.3</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">portainer</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./data:/data</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.enable=true&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.portainer.rule=Host(`portainer.lab.ferjan.net`)&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.portainer.entrypoints=https&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.portainer.tls=true&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.services.portainer.loadbalancer.server.port=9000&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proxy</span>
<span class="w">    </span><span class="c1"># command: --log-level DEBUG</span>
<span class="w">    </span><span class="nt">extra_hosts</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;authentik.lab.ferjan.net=192.168.1.10&quot;</span><span class="w"> </span><span class="c1"># only if u don&#39;t use DNS</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">proxy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<blockquote>
<p><code>extra_hosts</code> definiramo le v primeru, da namesto DNS uporabljamo lokalno hosts dototeko. Portainer potrebuje informacijo na katerem IP naslovu se nahaja naš Authentik, sicer Oauth ne bo deloval. V primeru, da smo imena vpisali v DNS (priporočljivo) lahko <code>extra_hosts</code> izpustimo.</p>
</blockquote>
<p>Zaženemo Portainer</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>Tako, Portainer je nastavljen. Odpremo lahko https://portainer.lab.ferjan.net in nastavimo geslo admin uporabnika.</p>
<h2 id="authentik">Authentik<a class="headerlink" href="#authentik" title="Permanent link">&para;</a></h2>
<p>Pripravimo datotečno strukturo za Authentik.</p>
<div class="highlight"><pre><span></span><code>./authentik
└──<span class="w"> </span>.env
└──<span class="w"> </span>docker-compose.yml
</code></pre></div>
<p>Pripravimo datoteko <code>docker-compose.yml</code>.</p>
<blockquote>
<p>Izhajamo lahko iz uradne <code>docker-compose.yml</code> datoteke (wget https://goauthentik.io/docker-compose.yml), ki jo prilagodimo za uporabo s Traefik.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">postgresql</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker.io/library/postgres:16.4</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">authentik-postgresql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">healthcheck</span><span class="p">:</span>
<span class="w">      </span><span class="nt">test</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;CMD-SHELL&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;pg_isready</span><span class="nv"> </span><span class="s">-d</span><span class="nv"> </span><span class="s">$${POSTGRES_DB}</span><span class="nv"> </span><span class="s">-U</span><span class="nv"> </span><span class="s">$${POSTGRES_USER}&quot;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">start_period</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20s</span>
<span class="w">      </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30s</span>
<span class="w">      </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">      </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5s</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">database:/var/lib/postgresql/data</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">POSTGRES_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PG_PASS:?database password required}</span>
<span class="w">      </span><span class="nt">POSTGRES_USER</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PG_USER:-authentik}</span>
<span class="w">      </span><span class="nt">POSTGRES_DB</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PG_DB:-authentik}</span>
<span class="w">    </span><span class="nt">env_file</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.env</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">backend</span>
<span class="w">  </span><span class="nt">redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker.io/library/redis:7.4.1</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">authentik-redis</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--save 60 1 --loglevel warning</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">healthcheck</span><span class="p">:</span>
<span class="w">      </span><span class="nt">test</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;CMD-SHELL&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;redis-cli</span><span class="nv"> </span><span class="s">ping</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">grep</span><span class="nv"> </span><span class="s">PONG&quot;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">start_period</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20s</span>
<span class="w">      </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30s</span>
<span class="w">      </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">      </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3s</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:/data</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">backend</span>
<span class="w">  </span><span class="nt">server</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ghcr.io/goauthentik/server:2024.8.3</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">authentik-server</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">server</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTHENTIK_REDIS__HOST</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">      </span><span class="nt">AUTHENTIK_POSTGRESQL__HOST</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
<span class="w">      </span><span class="nt">AUTHENTIK_POSTGRESQL__USER</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PG_USER:-authentik}</span>
<span class="w">      </span><span class="nt">AUTHENTIK_POSTGRESQL__NAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PG_DB:-authentik}</span>
<span class="w">      </span><span class="nt">AUTHENTIK_POSTGRESQL__PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PG_PASS}</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./media:/media</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./custom-templates:/templates</span>
<span class="w">    </span><span class="nt">env_file</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.env</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.enable=true&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.authentik.rule=Host(`authentik.lab.ferjan.net`)&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.authentik.entrypoints=https&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.routers.authentik.tls=true&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.http.services.authentik.loadbalancer.server.port=9000&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;traefik.docker.network=proxy&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">backend</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proxy</span>
<span class="w">  </span><span class="nt">worker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ghcr.io/goauthentik/server:2024.8.3</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">authentik-worker</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">worker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTHENTIK_REDIS__HOST</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">      </span><span class="nt">AUTHENTIK_POSTGRESQL__HOST</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
<span class="w">      </span><span class="nt">AUTHENTIK_POSTGRESQL__USER</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PG_USER:-authentik}</span>
<span class="w">      </span><span class="nt">AUTHENTIK_POSTGRESQL__NAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PG_DB:-authentik}</span>
<span class="w">      </span><span class="nt">AUTHENTIK_POSTGRESQL__PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PG_PASS}</span>
<span class="w">    </span><span class="c1"># `user: root` and the docker socket volume are optional.</span>
<span class="w">    </span><span class="c1"># See more for the docker socket integration here:</span>
<span class="w">    </span><span class="c1"># https://goauthentik.io/docs/outposts/integrations/docker</span>
<span class="w">    </span><span class="c1"># Removing `user: root` also prevents the worker from fixing the permissions</span>
<span class="w">    </span><span class="c1"># on the mounted folders, so when removing this make sure the folders have the correct UID/GID</span>
<span class="w">    </span><span class="c1"># (1000:1000 by default)</span>
<span class="w">    </span><span class="c1">#user: root</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="c1">#  - /var/run/docker.sock:/var/run/docker.sock</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./media:/media</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./certs:/certs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./custom-templates:/templates</span>
<span class="w">    </span><span class="nt">env_file</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.env</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">backend</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">database</span><span class="p">:</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local</span>
<span class="w">  </span><span class="nt">redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">proxy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<p>Pripravimo <code>.env</code> spremenljivke:</p>
<div class="highlight"><pre><span></span><code># Create .env variables 
echo &quot;PG_PASS=$(openssl rand -base64 36 | tr -d &#39;\n&#39;)&quot; &gt;&gt; .env
echo &quot;AUTHENTIK_SECRET_KEY=$(openssl rand -base64 60 | tr -d &#39;\n&#39;)&quot; &gt;&gt; .env
echo &quot;AUTHENTIK_ERROR_REPORTING__ENABLED=true&quot; &gt;&gt; .env
</code></pre></div>
<p>Poženemo docker vsebnik.</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>Preverimo, da so se vsebniki uspešno zagnali in da ne pišejo napak v log zapise. </p>
<blockquote>
<p>POZOR: Vsebnika server in worker se zaganjata malce dlje časa.</p>
</blockquote>
<h3 id="nastavitve-authentik">Nastavitve Authentik<a class="headerlink" href="#nastavitve-authentik" title="Permanent link">&para;</a></h3>
<p>Odpremo https://authentik.lab.ferjan.net/. Če smo vse naredili prav nas bo pričakalo prijavno okno Authentika.
Pred prvo prijavo si ustvarimo inicialni uporabniški račun na naslovu https://authentik.lab.ferjan.net/if/flow/initial-setup/.</p>
<p>V admin nastavitvah si poleg privzetega admin uporabnika <code>akadmin</code> naredimo še svojega uporabnika, mu nastavimo geslo, ga damo v admin grupo in mu vklopimo MFA.</p>
<p>Preverimo prijavo s svojim uporabnikom preko MFA in onemogočimo privzeti račun <code>akadmin</code>.</p>
<blockquote>
<p>Pri vklopu MFA sem imel nekaj težav, ki jih je rešil šele ponovni zagon.</p>
</blockquote>
<h4 id="dodajanje-novega-providerja-v-authentik">Dodajanje novega providerja v Authentik<a class="headerlink" href="#dodajanje-novega-providerja-v-authentik" title="Permanent link">&para;</a></h4>
<p>Za začetek dodamo OAuth2/OpenID providerja z imenom <strong>portainer</strong>.
Zabeležimo si <strong>ClientID</strong> in <strong>ClientSecret</strong>.
Za <strong>redirectURIs</strong> nastavimo naslov našega Porteinerja, t.j. https://portainer.lab.ferjan.net/</p>
<h4 id="dodajanje-aplikacije-v-authentik">Dodajanje aplikacije v Authentik<a class="headerlink" href="#dodajanje-aplikacije-v-authentik" title="Permanent link">&para;</a></h4>
<p>Pod Applicatins &gt; Applications dodamo novo aplikacijo <strong>Portainer</strong>.</p>
<p>Ime: Portainer</p>
<p>Slug: portainer</p>
<p>Provider: portainer </p>
<h4 id="nastavitve-portainer-za-oauth">Nastavitve Portainer za Oauth<a class="headerlink" href="#nastavitve-portainer-za-oauth" title="Permanent link">&para;</a></h4>
<p>V nastavitveh Portainerja pod Settings &gt; Authentication nato nastavimo Oauth, označimo "Automatic user provisioning".</p>
<p>Za OAuth konfiguracijo sledimo dokumentaciji https://docs.goauthentik.io/integrations/services/portainer/.</p>
<blockquote>
<p>Pri Logout URL-ju pazimo, da uporabimo ime našega portainerja</p>
</blockquote>
<h4 id="test-delovanja">Test delovanja<a class="headerlink" href="#test-delovanja" title="Permanent link">&para;</a></h4>
<p>Odjavimo se iz Portainerja in se ponovno prijavimo, tokrat z Oauth.
Če smo vse prav naredili nas bo prijavilo v Portainer z uporabnikom s katerim smo prijavljeni v Authentik.
Ker uporabnik v Portainerju še nima ustreznih pravic se v Portainer ponovno prijavimo z internim admin uporabnikom, ter novega uporabnika dodamo v ustrezno skupino (npr. med admine).</p>
<h2 id="nastavitve-mac-os-za-neprestano-delovanje">Nastavitve Mac OS za neprestano delovanje<a class="headerlink" href="#nastavitve-mac-os-za-neprestano-delovanje" title="Permanent link">&para;</a></h2>
<p>Kot že omenjeno celotna postavitev teče na starejšem Macbook PRO prenosniku. V kolikor bo homelab neprestano prižgan bo potrebno nastaviti, da se prenosnik ne bo samodejno ugasnil in da bo deloval tudi pri zaprtem zaslonu.</p>
<p>Za delovanje pri zaprtem zaslonu nastavimo <strong>System Preferences &gt; Battery &gt; Power adapter &gt; prevent computer from sleeping automatically when the display is off</strong>.</p>
<p>Za preprečitev samodejnega ugašanja namestimo in vklopimo aplikacijo <strong>Amphetamine</strong>.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Nazaj na vrh
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Jaka Ferjan
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/ferjan/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@JakaFerjan" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.tiktok.com/@fotrjaka" target="_blank" rel="noopener" title="www.tiktok.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M448.5 209.9c-44 .1-87-13.6-122.8-39.2v178.7c0 33.1-10.1 65.4-29 92.6s-45.6 48-76.6 59.6-64.8 13.5-96.9 5.3-60.9-25.9-82.7-50.8-35.3-56-39-88.9 2.9-66.1 18.6-95.2 40-52.7 69.6-67.7 62.9-20.5 95.7-16v89.9c-15-4.7-31.1-4.6-46 .4s-27.9 14.6-37 27.3-14 28.1-13.9 43.9 5.2 31 14.5 43.7 22.4 22.1 37.4 26.9 31.1 4.8 46-.1 28-14.4 37.2-27.1 14.2-28.1 14.2-43.8V0h88c-.1 7.4.6 14.9 1.9 22.2 3.1 16.3 9.4 31.9 18.7 45.7s21.3 25.6 35.2 34.6c19.9 13.1 43.2 20.1 67 20.1V210z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/jferjan" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://hub.docker.com/u/jferjan" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.komoot.com/user/812042217858" target="_blank" rel="noopener" title="www.komoot.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16 1.2c-1 0-1.8.8-1.8 1.8S15 4.8 16 4.8 17.8 4 17.8 3 17 1.2 16 1.2m-3.6 2.9c-.47 0-.9.19-1.2.5L7.5 8.29C7.19 8.6 7 9 7 9.5c0 .63.33 1.16.85 1.47L11.2 13v5H13v-6.5l-2.25-1.65 2.32-2.35L14.8 10H19V8.2h-3.2l-1.94-3.27c-.29-.5-.86-.83-1.46-.83M10 3H3c-.55 0-1-.45-1-1s.45-1 1-1h9.79c-.21.34-.38.71-.47 1.11-.86.02-1.67.34-2.32.89m-5 9c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0 8.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5M19 12c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0 8.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5M5.32 11H1c-.552 0-1-.45-1-1s.448-1 1-1h4.05c-.02.16-.05.33-.05.5 0 .53.12 1.04.32 1.5M6 7H2c-.55 0-1-.45-1-1s.45-1 1-1h5.97L6.09 6.87C6.05 6.91 6 6.96 6 7"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.top", "navigation.indexes", "toc.follow", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Kopirano v odlo\u017ei\u0161\u010de", "clipboard.copy": "Kopiraj v odlo\u017ei\u0161\u010de", "search.result.more.one": "\u0160e 1 na tej strani", "search.result.more.other": "\u0160e # na tej strani", "search.result.none": "Ni zadetkov", "search.result.one": "1 zadetek", "search.result.other": "# zadetkov", "search.result.placeholder": "Vpi\u0161i iskalni niz", "search.result.term.missing": "Manjka", "select.version": "Izberi razli\u010dico"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../js/noindex.js"></script>
      
    
  </body>
</html>