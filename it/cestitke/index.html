
<!doctype html>
<html lang="sl" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jaka.ferjan.net/it/cestitke/">
      
      
        <link rel="prev" href="../spletno-mesto/">
      
      
        <link rel="next" href="../homelab/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Ferjanove avtomatične čestitke - jaka.ferjan.net</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link rel="icon" type="image/png" href="/img/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/img/favicon.svg" />
  <link rel="icon" type="image/x-icon" href="/img/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="Jaka Ferjan" />
  <link rel="manifest" href="site.webmanifest" />
  

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ferjanove-avtomaticne-cestitke-avtomatizacija-cestitk-za-rojstni-dan" class="md-skip">
          Skoči na vsebino
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Noga">
    <a href="../.." title="jaka.ferjan.net" class="md-header__button md-logo" aria-label="jaka.ferjan.net" data-md-component="logo">
      
  <img src="../../img/JF_logo_white_on_transparent.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            jaka.ferjan.net
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ferjanove avtomatične čestitke
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Preklopi na temni način"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Preklopi na temni način" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Preklopi na svetli način"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Preklopi na svetli način" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Išči" placeholder="Išči" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Iskanje">
        
        <button type="reset" class="md-search__icon md-icon" title="Počisti" aria-label="Počisti" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializacija iskanja
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Zavihki" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Informacijska Tehnologija

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../kolesarjenje/" class="md-tabs__link">
          
  
  
    
  
  Kolesarjenje

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../hribi/" class="md-tabs__link">
          
  
  
    
  
  Hribi

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../potapljanje/" class="md-tabs__link">
          
  
  
    
  
  Potapljanje

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigacija" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="jaka.ferjan.net" class="md-nav__button md-logo" aria-label="jaka.ferjan.net" data-md-component="logo">
      
  <img src="../../img/JF_logo_white_on_transparent.png" alt="logo">

    </a>
    jaka.ferjan.net
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Informacijska Tehnologija
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Informacijska Tehnologija
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spletno-mesto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Potrebuješ brezplačno spletno mesto?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Ferjanove avtomatične čestitke
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Ferjanove avtomatične čestitke
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Kazalo">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Kazalo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kaj-potrebujemo" class="md-nav__link">
    <span class="md-ellipsis">
      Kaj potrebujemo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kaj potrebujemo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spletni-obrazec-za-prijavo" class="md-nav__link">
    <span class="md-ellipsis">
      Spletni obrazec za prijavo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zbirka-prijavljenih-uporabnikov" class="md-nav__link">
    <span class="md-ellipsis">
      Zbirka prijavljenih uporabnikov
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skripta-onformsubmit" class="md-nav__link">
    <span class="md-ellipsis">
      Skripta OnFormSubmit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skripta-z-api-jem-za-prijavoodjavo-od-storitve" class="md-nav__link">
    <span class="md-ellipsis">
      Skripta z API-jem za prijavo/odjavo od storitve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skripta-za-posiljanje-cestitk" class="md-nav__link">
    <span class="md-ellipsis">
      Skripta za pošiljanje čestitk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skripta-za-garbage-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Skripta za garbage collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pravice-za-skripte" class="md-nav__link">
    <span class="md-ellipsis">
      Pravice za skripte
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-za-funkcijo-onformsubmit" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger za funkcijo OnFormSubmit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-za-funkcijo-sendbdaywishes" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger za funkcijo sendBdayWishes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-za-funkcijo-garbagecollection" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger za funkcijo garbageCollection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promocijski-naslov-storitve-dns-preusmeritev" class="md-nav__link">
    <span class="md-ellipsis">
      Promocijski naslov storitve (DNS, preusmeritev)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postni-naslov" class="md-nav__link">
    <span class="md-ellipsis">
      Poštni naslov
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homelab/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Homelab z Docker, Traefik, Portainer, Authentik
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../forward-auth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vnaprejšnja avtentikacija z Authentikom in Traefikom
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tailscale-in-headscale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tailscale in Headscale zasebno omrežje
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blokada-chatgpt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kako blokirati ChatGPT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../no-sleep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Powershelll skripta za preprečevanje neaktivnosti
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../moj-ca/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Si želiš imeti svoj CA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smrekca/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Smrekca, razvejana, obrezana, zapakirana
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../github-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testiranje GitHub Actions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../kolesarjenje/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Kolesarjenje
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Kolesarjenje
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kolesarjenje/bikepacking-gear/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bikepacking gear
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../hribi/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Hribi
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Hribi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hribi/rob-smrti/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Po bližnjici na rob smrti
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hribi/bivak-v-snegu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trodnevni snežni bivak na Komni
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../potapljanje/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Potapljanje
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Potapljanje
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Kazalo">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Kazalo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kaj-potrebujemo" class="md-nav__link">
    <span class="md-ellipsis">
      Kaj potrebujemo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kaj potrebujemo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spletni-obrazec-za-prijavo" class="md-nav__link">
    <span class="md-ellipsis">
      Spletni obrazec za prijavo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zbirka-prijavljenih-uporabnikov" class="md-nav__link">
    <span class="md-ellipsis">
      Zbirka prijavljenih uporabnikov
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skripta-onformsubmit" class="md-nav__link">
    <span class="md-ellipsis">
      Skripta OnFormSubmit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skripta-z-api-jem-za-prijavoodjavo-od-storitve" class="md-nav__link">
    <span class="md-ellipsis">
      Skripta z API-jem za prijavo/odjavo od storitve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skripta-za-posiljanje-cestitk" class="md-nav__link">
    <span class="md-ellipsis">
      Skripta za pošiljanje čestitk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skripta-za-garbage-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Skripta za garbage collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pravice-za-skripte" class="md-nav__link">
    <span class="md-ellipsis">
      Pravice za skripte
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-za-funkcijo-onformsubmit" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger za funkcijo OnFormSubmit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-za-funkcijo-sendbdaywishes" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger za funkcijo sendBdayWishes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-za-funkcijo-garbagecollection" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger za funkcijo garbageCollection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promocijski-naslov-storitve-dns-preusmeritev" class="md-nav__link">
    <span class="md-ellipsis">
      Promocijski naslov storitve (DNS, preusmeritev)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postni-naslov" class="md-nav__link">
    <span class="md-ellipsis">
      Poštni naslov
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
        <a href="../../zapisi/#tag:it" class="md-tag">IT</a>
      
    
  </nav>



<h1 id="ferjanove-avtomaticne-cestitke-avtomatizacija-cestitk-za-rojstni-dan">Ferjanove avtomatične čestitke - avtomatizacija čestitk za rojstni dan<a class="headerlink" href="#ferjanove-avtomaticne-cestitke-avtomatizacija-cestitk-za-rojstni-dan" title="Permanent link">&para;</a></h1>
<p><img alt="Cestitke" referrerpolicy="no-referrer" src="https://lh3.googleusercontent.com/pw/AP1GczOH2U2pMiCVPIgJOvfa65UkaDtIC-RN3SIPhbIqrEqC1LyrlAD0gihhQYcmUhFY74JssEkoYcS7ggAGeFhC4W-QLp_8jjSBTLqcBf4vVyyf9QujVDH2bxV8II663A4K6Q2ndITRMgFMcDW1O9a0_rDEFA=w1920-h480-s-no-gm?authuser=0" title="Cestitke" /></p>
<p>Saj veš kako to ponavadi poteka. Tvoj koledar, Facebook ali podobna storitev ti pošlje avtomatizirano obvestilo, da ima prijatelj rojstni dan. Ker si dober prijatelj mu pošlješ en izviren "Vse najboljše za rojstni dan!", čemur po navadi sledi en izviren "Hvala!". Prijateljev imaš seveda veliko zato ta korak ponoviš vsaj enkrat na teden. </p>
<p>Kaj pa če ... bi zadevo avtomatizirali, tako da bi "izvirno" čestitko prejel vsak prijatelj, ki si to resnično želi.</p>
<p>Spoznaj <strong>Ferjanove avtomatične čestitke<sup>TM</sup></strong>. Storitev, ki prijateljem omogoča, da se naročijo na avtomatizirane čestitke za svoj rojstni dan.</p>
<p><a class="md-button md-button--primary" href="http://cestitke.ferjan.net"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z"/></svg></span>  cestitke.ferjan.net</a></p>
<blockquote>
<p>Da ne bo kdo narobe razumel. Svoje prijatelje za rojstni dan raje pokliči/obišči in jim čestitaj iz srca.
Pričujoča storitev je namenjena zgolj učenju Google APP scripta. Gre za nekakšen "proof of concept" primer, ki sem ga uporabil za spoznavanje osnov Google APP scripta. </p>
</blockquote>
<h2 id="kaj-potrebujemo">Kaj potrebujemo<a class="headerlink" href="#kaj-potrebujemo" title="Permanent link">&para;</a></h2>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="#spletni-obrazec-za-prijavo">Spletni obrazec za prijavo</a> (Google Forms)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="#zbirka-prijavljenih-uporabnikov">Zbirko prijavljenih uporabnikov</a> (Google Spreadsheets)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Predloge <ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="">Predloga za potrditev prijave na storitev</a> (Google Docs)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://docs.google.com/document/d/1IacJM0pHSt1yHQYh9XFCMD1pdDNMS_2mi1MLa9uWbwg/edit?usp=sharing">Predloga za pošiljanje čestitke</a> (Google Docs)</li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Skripte<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="#skripta-onformsubmit">Skripta OnFormSubmit</a> (Google Apps Script)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="#skripta-z-api-jem-za-prijavoodjavo-od-storitve">Skripta z API-jem za prijavo/odjavo od storitve</a> (Google Apps Script)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="#skripta-za-posiljanje-cestitk">Skripta za pošiljanje čestitk</a> (Google Apps Script)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="#skripta-za-garbage-collection">Skripta za "Garbage Collection"</a> (Google Apps Script)</li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="#pravice-za-skripte">Pravice za skripte</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Triggerji za skripte<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="#trigger-za-funkcijo-onformsubmit">Trigger za funkcijo <code>OnFormSubmit</code></a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="#trigger-za-funkcijo-sendbdaywishes">Trigger za funkcijo <code>sendBdayWishes</code></a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="#trigger-za-funkcijo-garbagecollection">Trigger za funkcijo <code>garbageCollection</code></a></li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Opcijsko<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="#promocijski-naslov-storitve-dns-preusmeritev">Promocijski naslov storitve</a> (DNS, preusmeritev)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="#postni-naslov-storitve">Poštni naslov storitve</a> (Google Workspace)</li>
</ul>
</li>
</ul>
<h3 id="spletni-obrazec-za-prijavo">Spletni obrazec za prijavo<a class="headerlink" href="#spletni-obrazec-za-prijavo" title="Permanent link">&para;</a></h3>
<p><a href="https://docs.google.com/forms/d/e/1FAIpQLSeDGwYFHfKZaCR3yZq9OfqTnXkaSsmVFsIaJUB_bvB6G-pkCw/viewform">Spletni obrazec</a> ima 5 obveznih polj:</p>
<ul>
<li>Polje za vnos e-mail naslova uporabnika.</li>
<li>Polje za vnos Imena uporabnika.</li>
<li>Polje za vnos datuma rojstva uporabnika.</li>
<li>Polje za soglasje k obdelavi osebnih podatkov (GDPR pa take fore)</li>
<li>Polje za soglasje s pogoji uporabe storitve.</li>
</ul>
<h3 id="zbirka-prijavljenih-uporabnikov">Zbirka prijavljenih uporabnikov<a class="headerlink" href="#zbirka-prijavljenih-uporabnikov" title="Permanent link">&para;</a></h3>
<p>Zbirka prijavljenih uporabnikov je Google Spreadsheets datoteka, ki jo avtomatično ustvari Google Forms.</p>
<p>Preglednica ima sledeče stolpce:</p>
<dl>
<dt><code>Časovni žig</code></dt>
<dd>
<p>Čas oddaje Google Forms obrazca.
Avtomatično zabeleženo ob dodaji obrazca.</p>
</dd>
<dt><code>E-poštni naslov</code>   </dt>
<dd>
<p>E-poštni naslov uporabnika storitve.
Avtomatično zabeleženo ob dodaji obrazca.</p>
</dd>
<dt><code>Ime</code></dt>
<dd>
<p>Ime uporabnika storitve.
Avtomatično zabeleženo ob dodaji obrazca.</p>
</dd>
<dt><code>Datum rojstva</code> </dt>
<dd>
<p>Datum rojstva uporabnika storitve.
Avtomatično zabeleženo ob dodaji obrazca.</p>
</dd>
<dt><code>Varstvo osebnih podatkov</code>  </dt>
<dd>
<p>Soglasje z obdelavo osebnih podatkov uporabnika storitve.
Avtomatično zabeleženo ob dodaji obrazca.</p>
</dd>
<dt><code>Pogoji uporabe</code>    </dt>
<dd>
<p>Soglasje s pogoji uporabe storitve.
Avtomatično zabeleženo ob dodaji obrazca.</p>
</dd>
</dl>
<p>Preglednico razširimo in dodamo tri dodatne stolpce:</p>
<dl>
<dt><code>Poslano</code>   </dt>
<dd>
<p>Časovni žig zadnjega pošiljanja čestite
Zabeleži skripta za pošiljanje čestitk ob pošiljanju.</p>
</dd>
<dt><code>formId</code>    </dt>
<dd>
<p>ID številka obrazca za prijavo na storitev.
Zabeleži skripta OnFormSubmit ob oddaji obrazca.</p>
</dd>
<dt><code>ActiveStatus</code></dt>
<dd>
<p>Polje v katerem beležimo, če je posamezna prijava aktivirana, t.j. je uporabnik potrdil lastništvo vnešenega e-mail naslova.
Zabeleži skripta z API-jem za prijavo/odjavo od storitve ob aktivaciji prijave.</p>
</dd>
</dl>
<h3 id="skripta-onformsubmit">Skripta OnFormSubmit<a class="headerlink" href="#skripta-onformsubmit" title="Permanent link">&para;</a></h3>
<p>Skripta vsebuje funkcije <code>OnFormSubmit</code>, <code>sendMail</code> in <code>replaceMarkerWithLink</code>.</p>
<p>Vsakič, ko nekdo odda obrazec, se sproži <a href="#trigger-za-funkcijo-onformsubmit">trigger za funkcijo OnFormSubmit</a>.</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">onFormSubmit</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Odpri preglednico </span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">openById</span><span class="p">(</span><span class="s1">&#39;1qV8b4QagcvoFoeq8hT4KqFJIq6U8DW9SbSpdYlk0hPI&#39;</span><span class="p">).</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="s1">&#39;Odzivi na obrazec 1&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">//</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">templateId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;16Efta4XTKXsDsd-YKkrfA9iEBYITr-YXrIvL1py9p44&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// the template doc with placeholders</span>

<span class="w">  </span><span class="c1">// Pridobi ID številko oddanega obrazca</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">formId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">getId</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Pridobi posredovani e-poštni naslov </span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">toMail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">getRespondentEmail</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Preverimo, če je formId že zabeležen (potrebno zaradi tega, da se potrdilo ne pošlje ponovno ob popravljanju obrazca)</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">isCellBlank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getLastRow</span><span class="p">(),</span><span class="w"> </span><span class="mf">8</span><span class="p">).</span><span class="nx">isBlank</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Če formId še ni zabeležen</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="nx">isCellBlank</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// Pošlji ID Forme na posredovani e-poštni naslov</span>
<span class="w">    </span><span class="nx">sendMail</span><span class="p">(</span><span class="nx">sheet</span><span class="p">,</span><span class="nx">templateId</span><span class="p">,</span><span class="nx">toMail</span><span class="p">,</span><span class="nx">formId</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Zapiši ID številko obrazca v osmi stolpec preglednice</span>
<span class="w">    </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getLastRow</span><span class="p">(),</span><span class="w"> </span><span class="mf">8</span><span class="p">).</span><span class="nx">setValue</span><span class="p">(</span><span class="nx">formId</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Zapiši status aktivacije v deveti stolpec preglednice</span>
<span class="w">    </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getLastRow</span><span class="p">(),</span><span class="w"> </span><span class="mf">9</span><span class="p">).</span><span class="nx">setValue</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// izbriši odgovor iz baze forme.</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">form</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">FormApp</span><span class="p">.</span><span class="nx">openByUrl</span><span class="p">(</span><span class="s1">&#39;https://docs.google.com/forms/d/1q3Zw-UMIk2xM_kHgbnbzSzBvcM4pC6ZGZthTfXuue-w/&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">form</span><span class="p">.</span><span class="nx">deleteResponse</span><span class="p">(</span><span class="nx">formId</span><span class="p">);</span><span class="w"> </span>

<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">sendMail</span><span class="p">(</span><span class="nx">sheet</span><span class="p">,</span><span class="nx">templateId</span><span class="p">,</span><span class="nx">toMail</span><span class="p">,</span><span class="nx">formId</span><span class="p">){</span>

<span class="w">  </span><span class="c1">// Poiščemo kje v predlogi se nahaja marker in ga zamenjamo z oblikovano povezavo</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">docId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">DriveApp</span><span class="p">.</span><span class="nx">getFileById</span><span class="p">(</span><span class="nx">templateId</span><span class="p">).</span><span class="nx">makeCopy</span><span class="p">(</span><span class="s1">&#39;temp&#39;</span><span class="p">).</span><span class="nx">getId</span><span class="p">();</span><span class="w"> </span><span class="c1">// Naredimo kopijo predloge</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">DocumentApp</span><span class="p">.</span><span class="nx">openById</span><span class="p">(</span><span class="nx">docId</span><span class="p">);</span><span class="w"> </span><span class="c1">// Odpremo kopijo predloge</span>

<span class="w">  </span><span class="c1">// Pokličemo funkcijo, ki v besedilu dokumenta zamenja marker s povezavo</span>
<span class="w">  </span><span class="nx">replaceMarkerWithLink</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;#potrditev#&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Potrdi prijavo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;https://script.google.com/a/ferjan.net/macros/s/AKfycbx7GLQLhKnS00iI2SIUiIa81DBRAhMpZfFA1vo1w4dQ9St4WS8/exec?id=&#39;</span><span class="w"> </span><span class="o">+</span><span class="nx">formId</span><span class="p">);</span>
<span class="w">  </span><span class="nx">replaceMarkerWithLink</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;#odjava#&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Odjava&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;https://script.google.com/a/ferjan.net/macros/s/AKfycbx7GLQLhKnS00iI2SIUiIa81DBRAhMpZfFA1vo1w4dQ9St4WS8/exec?unsubscribe=1&amp;id=&#39;</span><span class="w"> </span><span class="o">+</span><span class="nx">formId</span><span class="p">);</span>

<span class="w">  </span><span class="nx">doc</span><span class="p">.</span><span class="nx">saveAndClose</span><span class="p">();</span><span class="w"> </span><span class="c1">// save changes before conversion</span>

<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://docs.google.com/feeds/download/documents/export/Export?id=&quot;</span><span class="o">+</span><span class="nx">docId</span><span class="o">+</span><span class="s2">&quot;&amp;exportFormat=html&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">param</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;get&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Bearer &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">getOAuthToken</span><span class="p">()}</span>
<span class="w">  </span><span class="p">};</span><span class="w">    </span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">htmlBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="nx">param</span><span class="p">).</span><span class="nx">getContentText</span><span class="p">();</span><span class="w"> </span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">trashed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">DriveApp</span><span class="p">.</span><span class="nx">getFileById</span><span class="p">(</span><span class="nx">docId</span><span class="p">).</span><span class="nx">setTrashed</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w"> </span><span class="c1">// delete temp copy  </span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">Rname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Ferjanove avtomatične čestitke&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Set real email-from name</span>

<span class="w">  </span><span class="nx">MailApp</span><span class="p">.</span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">toMail</span><span class="p">,</span><span class="s1">&#39;Potrditev prijave&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="p">,{</span><span class="nx">htmlBody</span><span class="o">:</span><span class="w"> </span><span class="nx">htmlBody</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="nx">Rname</span><span class="p">});</span>

<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">replaceMarkerWithLink</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="nx">marker</span><span class="p">,</span><span class="w"> </span><span class="nx">replaceMarkerTxt</span><span class="p">,</span><span class="w"> </span><span class="nx">replaceMarkerUrl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">getBody</span><span class="p">().</span><span class="nx">findText</span><span class="p">(</span><span class="nx">marker</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="nx">element</span><span class="p">){</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">element</span><span class="p">.</span><span class="nx">getStartOffset</span><span class="p">();</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">element</span><span class="p">.</span><span class="nx">getElement</span><span class="p">().</span><span class="nx">asText</span><span class="p">();</span>
<span class="w">    </span><span class="nx">text</span><span class="p">.</span><span class="nx">replaceText</span><span class="p">(</span><span class="nx">marker</span><span class="p">,</span><span class="nx">replaceMarkerTxt</span><span class="p">);</span>
<span class="w">    </span><span class="nx">text</span><span class="p">.</span><span class="nx">setLinkUrl</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span><span class="w"> </span><span class="nx">start</span><span class="o">+</span><span class="nx">replaceMarkerTxt</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">replaceMarkerUrl</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="skripta-z-api-jem-za-prijavoodjavo-od-storitve">Skripta z API-jem za prijavo/odjavo od storitve<a class="headerlink" href="#skripta-z-api-jem-za-prijavoodjavo-od-storitve" title="Permanent link">&para;</a></h3>
<p>To skripto je potrebno objaviti (<strong>Deploy this project</strong>), da dobimo DeploymentID in URL.
Ta URL uporabimo v skriptah na delih, kjer potrebujemo URL za potrditev prijave in za odjavo od storitve.</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Povzeto po https://gist.github.com/mhawksey/1276293</span>
<span class="c1">// Popravljen bug https://issuetracker.google.com/issues/72798634 #13 in #18 dodan /a/ferjan.net/ v API URL</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">doGet</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">handleResponse</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">handleResponse</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// LockService prevents concurrent access overwritting data</span>
<span class="w">  </span><span class="c1">// http://googleappsdeveloper.blogspot.co.uk/2011/10/concurrency-and-google-apps-script.html</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">lock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">LockService</span><span class="p">.</span><span class="nx">getPublicLock</span><span class="p">();</span>
<span class="w">  </span><span class="nx">lock</span><span class="p">.</span><span class="nx">waitLock</span><span class="p">(</span><span class="mf">30000</span><span class="p">);</span><span class="w">  </span><span class="c1">// wait 30 seconds before conceding defeat.</span>

<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Pridobimo id iz GET zahtevka</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">parameter</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// V primeru, da id parameter ni podan izpišemo napako</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">ContentService</span>
<span class="w">          </span><span class="p">.</span><span class="nx">createTextOutput</span><span class="p">(</span><span class="s2">&quot;Zahtevek ne vsebuje parametra z ID številko uporabnika.&quot;</span><span class="p">);</span><span class="w">    </span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Pridobimo unsubscribe parameter</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">unsubscribe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">parameter</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Nastavimo kam bomo pisali</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">openById</span><span class="p">(</span><span class="s1">&#39;1qV8b4QagcvoFoeq8hT4KqFJIq6U8DW9SbSpdYlk0hPI&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="s1">&#39;Odzivi na obrazec 1&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Nastavimo pravilno vrstico glede na vrednost id. V ta namen uporabimo dodatno funkcijo findRowByValue.</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">findRowByValue</span><span class="p">(</span><span class="nx">sheet</span><span class="p">,</span><span class="nx">id</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Nastavimo stolpec, ki vsebuje podatek o statusu aktivacije</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">columnActiveStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">9</span><span class="p">;</span><span class="w">    </span>

<span class="w">    </span><span class="c1">// V primeru, da vrstice za zahtevani id ne najdemo izpišemo napako</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">row</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">ContentService</span>
<span class="w">          </span><span class="p">.</span><span class="nx">createTextOutput</span><span class="p">(</span><span class="s2">&quot;Uporabnik s to ID številko ne obstaja.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Pohendlamo morebiten unsubscribe</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">unsubscribe</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">deleteRow</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">ContentService</span>
<span class="w">          </span><span class="p">.</span><span class="nx">createTextOutput</span><span class="p">(</span><span class="s2">&quot;Vaša prijava na Ferjanove avtomatične čestitke je odstranjena.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Zapišemo vrednost 1, ki pomeni, da je prijava aktivna</span>
<span class="w">    </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span><span class="nx">columnActiveStatus</span><span class="p">).</span><span class="nx">setValue</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// vrnemo pozitiven odgovor</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">ContentService</span>
<span class="w">          </span><span class="p">.</span><span class="nx">createTextOutput</span><span class="p">(</span><span class="s2">&quot;Vaša prijava na Ferjanove avtomatične čestitke je aktivirana.&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
<span class="w">    </span><span class="c1">// v primeru napake vrnemo error</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">ContentService</span>
<span class="w">          </span><span class="p">.</span><span class="nx">createTextOutput</span><span class="p">(</span><span class="s2">&quot;Napaka&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">//release lock</span>
<span class="w">    </span><span class="nx">lock</span><span class="p">.</span><span class="nx">releaseLock</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Funkcija, ki poišče številko vrstice z določeno vrednostjo v stolpcu H2:H</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">findRowByValue</span><span class="p">(</span><span class="nx">sheet</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">lastRow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getLastRow</span><span class="p">();</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">dataRange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="s1">&#39;H2:H&#39;</span><span class="o">+</span><span class="nx">lastRow</span><span class="p">);</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dataRange</span><span class="p">.</span><span class="nx">getValues</span><span class="p">();</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">values</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">i</span><span class="o">+</span><span class="mf">2</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">;</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div>
<h3 id="skripta-za-posiljanje-cestitk">Skripta za pošiljanje čestitk<a class="headerlink" href="#skripta-za-posiljanje-cestitk" title="Permanent link">&para;</a></h3>
<p>Vsak dan med 9h in 10h se poganja <a href="#trigger-za-funkcijo-sendbdaywishes">trigger, ki sproži funkcijo sendBdayWishes</a>. Funkcija <code>sendBdayWishes</code> preveri, če se današnji datum ujema s kakšnim rojstnim datumom. V kolikor pride do ujemanja pokliče funkcijo <code>sendMail</code>, ki pošlje čestitko s pomočjo predloge.</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">sendBdayWishes</span><span class="p">(){</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">ss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">openByUrl</span><span class="p">(</span><span class="s2">&quot;https://docs.google.com/spreadsheets/d/1qV8b4QagcvoFoeq8hT4KqFJIq6U8DW9SbSpdYlk0hPI/&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Google SpreadSheet URL - To je naša baza uporabnikov</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ss</span><span class="p">.</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="s2">&quot;Odzivi na obrazec 1&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Google SpreadSheet - Sheet name - Ime zavihka v preglednici</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">templateId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1IacJM0pHSt1yHQYh9XFCMD1pdDNMS_2mi1MLa9uWbwg&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Template doc - Predloga za pošiljanje čestitke</span>

<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">cDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">();</span><span class="w"> </span><span class="c1">//Present Day, </span>
<span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="mf">2</span><span class="w"> </span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;=</span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getLastRow</span><span class="p">();</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>

<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">bDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="mf">4</span><span class="p">).</span><span class="nx">getValue</span><span class="p">();</span><span class="w"> </span><span class="c1">// Date from SpreadSheet </span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">cDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span><span class="o">==</span><span class="nx">bDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()){</span>
<span class="w">      </span><span class="k">if</span><span class="p">(</span><span class="nx">cDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">==</span><span class="nx">bDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()){</span>
<span class="w">        </span><span class="c1">// Pošljemo le uporabnikom s potrjeno aktivacijo, t.j. tistim, ki imajo v 9. stolpcu vrednost 1</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="mf">9</span><span class="p">).</span><span class="nx">getValue</span><span class="p">()</span><span class="o">==</span><span class="mf">1</span><span class="p">){</span>
<span class="w">          </span><span class="kd">var</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="mf">3</span><span class="p">).</span><span class="nx">getValue</span><span class="p">();</span>
<span class="w">          </span><span class="kd">var</span><span class="w"> </span><span class="nx">toMail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="mf">2</span><span class="p">).</span><span class="nx">getValue</span><span class="p">();</span>
<span class="w">          </span><span class="kd">var</span><span class="w"> </span><span class="nx">formId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="mf">8</span><span class="p">).</span><span class="nx">getValue</span><span class="p">();</span>
<span class="w">          </span><span class="nx">sendMail</span><span class="p">(</span><span class="nx">sheet</span><span class="p">,</span><span class="nx">templateId</span><span class="p">,</span><span class="nx">name</span><span class="p">,</span><span class="nx">toMail</span><span class="p">,</span><span class="nx">formId</span><span class="p">);</span>
<span class="w">          </span><span class="c1">// V stolpec 7 zabeležimo kdaj smo poslali e-pošto</span>
<span class="w">          </span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="mf">7</span><span class="p">).</span><span class="nx">setValue</span><span class="p">(</span><span class="nx">cDate</span><span class="p">);</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>


<span class="kd">function</span><span class="w"> </span><span class="nx">sendMail</span><span class="p">(</span><span class="nx">sheet</span><span class="p">,</span><span class="nx">templateId</span><span class="p">,</span><span class="nx">name</span><span class="p">,</span><span class="nx">toMail</span><span class="p">,</span><span class="nx">formId</span><span class="p">){</span>

<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">docId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">DriveApp</span><span class="p">.</span><span class="nx">getFileById</span><span class="p">(</span><span class="nx">templateId</span><span class="p">).</span><span class="nx">makeCopy</span><span class="p">(</span><span class="s1">&#39;temp&#39;</span><span class="p">).</span><span class="nx">getId</span><span class="p">();</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">DocumentApp</span><span class="p">.</span><span class="nx">openById</span><span class="p">(</span><span class="nx">docId</span><span class="p">);</span><span class="w"> </span><span class="c1">// the temp copy</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">getBody</span><span class="p">();</span>

<span class="w">  </span><span class="nx">body</span><span class="p">.</span><span class="nx">replaceText</span><span class="p">(</span><span class="s1">&#39;#name#&#39;</span><span class="p">,</span><span class="nx">name</span><span class="p">);</span><span class="w"> </span><span class="c1">// Zamenjaj marker za #name# z vrednostjo spremenjivke name</span>

<span class="w">  </span><span class="c1">// Poiščemo kje v predlogi se nahaja marker za odjavo in ga zamenjamo z oblikovano povezavo</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">marker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;#odjava#&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">replaceMarkerTxt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Odjava&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// Popravljen bug https://issuetracker.google.com/issues/72798634 #13 in #18 dodan /a/ferjan.net/ v API URL</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">replaceMarkerUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;https://script.google.com/a/ferjan.net/macros/s/AKfycbx7GLQLhKnS00iI2SIUiIa81DBRAhMpZfFA1vo1w4dQ9St4WS8/exec?unsubscribe=1&amp;id=&#39;</span><span class="w"> </span><span class="o">+</span><span class="nx">formId</span><span class="p">;</span>

<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">getBody</span><span class="p">().</span><span class="nx">findText</span><span class="p">(</span><span class="nx">marker</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="nx">element</span><span class="p">){</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">element</span><span class="p">.</span><span class="nx">getStartOffset</span><span class="p">();</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">element</span><span class="p">.</span><span class="nx">getElement</span><span class="p">().</span><span class="nx">asText</span><span class="p">();</span>
<span class="w">    </span><span class="nx">text</span><span class="p">.</span><span class="nx">replaceText</span><span class="p">(</span><span class="nx">marker</span><span class="p">,</span><span class="nx">replaceMarkerTxt</span><span class="p">);</span>
<span class="w">    </span><span class="nx">text</span><span class="p">.</span><span class="nx">setLinkUrl</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span><span class="w"> </span><span class="nx">start</span><span class="o">+</span><span class="nx">replaceMarkerTxt</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">replaceMarkerUrl</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">doc</span><span class="p">.</span><span class="nx">saveAndClose</span><span class="p">();</span><span class="w"> </span><span class="c1">// save changes before conversion</span>

<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://docs.google.com/feeds/download/documents/export/Export?id=&quot;</span><span class="o">+</span><span class="nx">docId</span><span class="o">+</span><span class="s2">&quot;&amp;exportFormat=html&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">param</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;get&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Bearer &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">getOAuthToken</span><span class="p">()}</span>
<span class="w">  </span><span class="p">};</span><span class="w">    </span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">htmlBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="nx">param</span><span class="p">).</span><span class="nx">getContentText</span><span class="p">();</span><span class="w"> </span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">trashed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">DriveApp</span><span class="p">.</span><span class="nx">getFileById</span><span class="p">(</span><span class="nx">docId</span><span class="p">).</span><span class="nx">setTrashed</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w"> </span><span class="c1">// delete temp copy  </span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">Rname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Ferjanove avtomatične čestitke&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Set real email-from name</span>

<span class="w">  </span><span class="nx">MailApp</span><span class="p">.</span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">toMail</span><span class="p">,</span><span class="s1">&#39;Vse najboljše &#39;</span><span class="o">+</span><span class="nx">name</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="p">,{</span><span class="nx">htmlBody</span><span class="o">:</span><span class="w"> </span><span class="nx">htmlBody</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="nx">Rname</span><span class="p">});</span>
</code></pre></div>
<h3 id="skripta-za-garbage-collection">Skripta za garbage collection<a class="headerlink" href="#skripta-za-garbage-collection" title="Permanent link">&para;</a></h3>
<p>Med 4h in 5h zjutraj se poganja <a href="#trigger-za-funkcijo-garbagecollection">trigger, ki sproži skripto garbageCollection</a> s katero počisti vse neaktivirane prijave.</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Skripta se poganja s triggerjem pozno ponoči, da ne bi sklučajno prezgodaj izbrisali še ne aktiviranih prijav.</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">garbageCollection</span><span class="p">(){</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">SS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">openById</span><span class="p">(</span><span class="s2">&quot;1qV8b4QagcvoFoeq8hT4KqFJIq6U8DW9SbSpdYlk0hPI&quot;</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">SHEET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">SS</span><span class="p">.</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="s2">&quot;Odzivi na obrazec 1&quot;</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">RANGE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">SHEET</span><span class="p">.</span><span class="nx">getDataRange</span><span class="p">();</span>


<span class="kd">var</span><span class="w"> </span><span class="nx">DELETE_VAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// Vrednost, ki je sprožilec za izbris</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">COL_TO_SEARCH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8</span><span class="p">;</span><span class="w"> </span><span class="c1">// The column to search for the DELETE_VAL (Zero is first)</span>


<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">rangeVals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">RANGE</span><span class="p">.</span><span class="nx">getValues</span><span class="p">();</span>

<span class="w">  </span><span class="c1">//Reverse the &#39;for&#39; loop.</span>
<span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rangeVals</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">--</span><span class="p">){</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">rangeVals</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">COL_TO_SEARCH</span><span class="p">]</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">DELETE_VAL</span><span class="p">){</span>

<span class="w">      </span><span class="nx">SHEET</span><span class="p">.</span><span class="nx">deleteRow</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mf">1</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="pravice-za-skripte">Pravice za skripte<a class="headerlink" href="#pravice-za-skripte" title="Permanent link">&para;</a></h3>
<p>Google Apps Script konzola nas ob prvem zagonu posamezne skipte pozove, da skripti dodelimo potrebne pravice. Skripta bo namreč upravljala z dokumenti, pošto, obrazcem, ipd. v našem imenu oz. v imenu našega Google računa. To je bil tudi eden izmed razlogov, da sem storitev postavil na ločenem Google računu.</p>
<h3 id="trigger-za-funkcijo-onformsubmit">Trigger za funkcijo <code>OnFormSubmit</code><a class="headerlink" href="#trigger-za-funkcijo-onformsubmit" title="Permanent link">&para;</a></h3>
<p>function: <strong>onFormSubmit</strong> <br />
runs at deployment: <strong>Head</strong> <br />
event source: <strong>From form</strong> <br />
event type <strong>On form submit</strong> <br />
failure notification: <strong>Notify me daily</strong></p>
<h3 id="trigger-za-funkcijo-sendbdaywishes">Trigger za funkcijo <code>sendBdayWishes</code><a class="headerlink" href="#trigger-za-funkcijo-sendbdaywishes" title="Permanent link">&para;</a></h3>
<p>function: <strong>sendBdayWishes</strong> <br />
runs at deployment: <strong>Head</strong> <br />
event source: <strong>Time-driven</strong> <br />
type of time based trigger: <strong>Day timer</strong> <br />
time of the day: <strong>9am to 10am</strong> <br />
failure notification: <strong>Notify me daily</strong></p>
<h3 id="trigger-za-funkcijo-garbagecollection">Trigger za funkcijo <code>garbageCollection</code><a class="headerlink" href="#trigger-za-funkcijo-garbagecollection" title="Permanent link">&para;</a></h3>
<p>function: <strong>garbageCollection</strong> <br />
runs at deployment: <strong>Head</strong> <br />
event source: <strong>Time-driven</strong> <br />
type of time based trigger: <strong>Day timer</strong> <br />
time of the day: <strong>4am to 5am</strong> <br />
failure notification: <strong>Notify me daily</strong></p>
<h3 id="promocijski-naslov-storitve-dns-preusmeritev">Promocijski naslov storitve (DNS, preusmeritev)<a class="headerlink" href="#promocijski-naslov-storitve-dns-preusmeritev" title="Permanent link">&para;</a></h3>
<p>Svojo domeno gostujem pri Cloudflare. Med DNS zapisi imam vpisan CNAME zapis <code>cestitke</code> za domeno <code>ferjan.net</code>. Nastavljeno imam tudi pravilo za preusmeritve:</p>
<p>If incoming requests match… <br />
Custom filter expression</p>
<p>Field: <code>Hostname</code> <br />
Operator: <code>equals</code> <br />
Value: <code>cestitke.ferjan.net</code></p>
<p>Then URL redirect</p>
<p>Type: <code>Static</code> <br />
URL: <code>https://docs.google.com/forms/d/e/1FAIpQLSeDGwYFHfKZaCR3yZq9OfqTnXkaSsmVFsIaJUB_bvB6G-pkCw/viewform</code> <br />
Status code: <code>302</code></p>
<h3 id="postni-naslov">Poštni naslov<a class="headerlink" href="#postni-naslov" title="Permanent link">&para;</a></h3>
<p>Storitev pošilja vse e-maile iz naslova cestitke@ferjan.net.</p>
<p>Pošto za domeno ferjan.net upravljam preko storitve <strong>Google Workspace for nonprofits</strong>. Za potrebe te storitve sem odprl Google Workspace račun cestitke@ferjan.net v katerem so shranjene tudi vse skripte za to storitev.</p>
<p><br />
...torej kaj še čakaš. Prijavi se! Tvoj rojstni dan je lahko že jutri. <img alt="😄" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f604.svg" title=":smile:" /></p>
<p><a class="md-button md-button--primary" href="http://cestitke.ferjan.net"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z"/></svg></span>  cestitke.ferjan.net</a></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Nazaj na vrh
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Jaka Ferjan
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/ferjan/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@JakaFerjan" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.tiktok.com/@fotrjaka" target="_blank" rel="noopener" title="www.tiktok.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M448.5 209.9c-44 .1-87-13.6-122.8-39.2v178.7c0 33.1-10.1 65.4-29 92.6s-45.6 48-76.6 59.6-64.8 13.5-96.9 5.3-60.9-25.9-82.7-50.8-35.3-56-39-88.9 2.9-66.1 18.6-95.2 40-52.7 69.6-67.7 62.9-20.5 95.7-16v89.9c-15-4.7-31.1-4.6-46 .4s-27.9 14.6-37 27.3-14 28.1-13.9 43.9 5.2 31 14.5 43.7 22.4 22.1 37.4 26.9 31.1 4.8 46-.1 28-14.4 37.2-27.1 14.2-28.1 14.2-43.8V0h88c-.1 7.4.6 14.9 1.9 22.2 3.1 16.3 9.4 31.9 18.7 45.7s21.3 25.6 35.2 34.6c19.9 13.1 43.2 20.1 67 20.1V210z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/jferjan" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://hub.docker.com/u/jferjan" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.komoot.com/user/812042217858" target="_blank" rel="noopener" title="www.komoot.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16 1.2c-1 0-1.8.8-1.8 1.8S15 4.8 16 4.8 17.8 4 17.8 3 17 1.2 16 1.2m-3.6 2.9c-.47 0-.9.19-1.2.5L7.5 8.29C7.19 8.6 7 9 7 9.5c0 .63.33 1.16.85 1.47L11.2 13v5H13v-6.5l-2.25-1.65 2.32-2.35L14.8 10H19V8.2h-3.2l-1.94-3.27c-.29-.5-.86-.83-1.46-.83M10 3H3c-.55 0-1-.45-1-1s.45-1 1-1h9.79c-.21.34-.38.71-.47 1.11-.86.02-1.67.34-2.32.89m-5 9c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0 8.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5M19 12c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0 8.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5M5.32 11H1c-.552 0-1-.45-1-1s.448-1 1-1h4.05c-.02.16-.05.33-.05.5 0 .53.12 1.04.32 1.5M6 7H2c-.55 0-1-.45-1-1s.45-1 1-1h5.97L6.09 6.87C6.05 6.91 6 6.96 6 7"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.top", "navigation.indexes", "toc.follow", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Kopirano v odlo\u017ei\u0161\u010de", "clipboard.copy": "Kopiraj v odlo\u017ei\u0161\u010de", "search.result.more.one": "\u0160e 1 na tej strani", "search.result.more.other": "\u0160e # na tej strani", "search.result.none": "Ni zadetkov", "search.result.one": "1 zadetek", "search.result.other": "# zadetkov", "search.result.placeholder": "Vpi\u0161i iskalni niz", "search.result.term.missing": "Manjka", "select.version": "Izberi razli\u010dico"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../js/noindex.js"></script>
      
    
  </body>
</html>